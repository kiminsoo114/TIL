
1 DNS(Domain Name System)이란?

1-1. 웹사이트에 접속 할 때 우리는 외우기 어려운 IP주소 대신 도메인 이름을 사용한다.
1-2. 도멘인 이름을 사용했을 때 입력한 도메인을 실제 네트워크상에서 사용하는 IP주소로 바꾸고
해당 IP주소로 접속하는 과정이 필요하다.
1-3. 이러한 과정, 전체 시스템을 DNS(도메인 네임 시스템)라고 한다.
1-4. 이러한 시스템은 전세계적으로 약속된 규칙을 공유한다.
1-5. 상위 기관에서 인증된 기관에게 도메인을 생성하거나 IP 주소로 변경할 수 있는 '권한'을 부여한다.
1-6. DNS는 이처럼 상위 기관과 하위 기관과 같은 '계층 구조'를 가지는 분산 데이터베이스 구조를 가진다.

2. DNS 구성 요소

DNS는 3개의 요소로 구성되어 있다.

2-1. 도메인 네임 스페이스(Domain Name Space)
2-2. 네임 서버(Name Server) = 권한이 있는 DNS 서버
2-3. 리졸버(Resolver) = 권한 없는 DNS 서버

우선 "이 도메인 이름은 이 IP주소이다" 라는 '텍스트'를 저장하는 데이터베이스가 필요로 한다.
그리고 분산된 데이터가 어디 저장되어 있는지 찾을 프로그램들이 필요하고 찾았으면 해당 IP주소로
이동할 프로그램(브라우저 등)이 필요하다.

"도메인 네임 스페이스" 라는 규칙(방법)으로 도메인 이름 저장을 분산한다.
"네임 서버(DNS서버와 같은 말)"가 해당 도메인 이름의 IP주소를 찾는다.
"리졸버"가 DNS 클라이언트 요청을 네임 서버로 전달하고 찾은 정보를 클라이언트에게 제공하는 기능을 수행한다.

어떤 네임 서버에서 찾아야하는지, 이미 캐시 되어있는지 등 찾아서 클라이언트에게 찾았는지 못찾았는지
전달하는 역할을 한다.

"리졸버"는 단말에 구현하는 것은 무리수라 보통은 리졸버가 구현된 네임 서버의 IP주소만을 파악한다.

대표적인 것이 KT/LG/SK와 같은 ISP(통신사) DNS가 있고 ,브라우저 우회 용도로 많이 사용하는 구글 DNS,
클라우드플레어와 같은 Public DNS 서버가 있다.

그래서 거의 Resolver = Recursive DNS Server = Local Server(of ISP) = Recursor로 사용

어떤 자료에서는 리졸버라는 요소를 생략하기도 한다.


순서를 요약하면
1. 도메인 이름 NAVER.COM을 브라우저에 입력하게 되면, 도메인 이름을 가지고 있는 네임서버(DNS서버)에 접속
2. 네임서버에 접속한 도메인(NAVER.COM)과 연결된 IP정보를 확인하고, IP를 사용자에게 전달
3. 사용자 PC는 전달받는 서버의 IP주소로 접속
4. 서버의 IP로 연결된 브라우저에 서버의 내용(홈페이지)을 출력


3. DNS 동작 방식 설명

3-1. 웹 브라우저 www.naver.com을 입력하면 먼저 PC에 저장된 LOCAL DNS(기지국 DNS 서버)에게 
"www.naver.com"이라는 hostname에 대한 IP주소를 요청한다.

IFNO)
LOCAL DNS란?
기본적으로 인터넷을 사용하기 위해선 IP를 할당해주는 통신사(KT,SKT,LG 등등)에 등록하게 된다.
컴퓨터의 LAN선을 통해 인터넷이 연결되면 가입했던 각 통신사의 기지국 DNS서버가 등록되게 된다.
그러니까 KT를 사용하는 집이면 KT DNS가 되는거고, SKT면 SKT DNS가 자동으로 셋팅되는 거다.

LOCAL DNS에는 정보가 있을 수도 있고 없을 수도 있다.(없다고 치자)
만약, 예전에 네이버에 접속했던 전적이 있다면, LOCAL DNS에 접속정보가 캐싱이 되어있어, 바로 PC에 
IP주소를 주고 끝낸다.

근데 만약 없다고 치자의 전제로 가면

LOCAL DNS는 이제 "www.naver.com"의 IP주소를 찾아내기 위해서 다른 DNS서버들과 통신(DNS쿼리)을 시작한다.
먼저 Root DNS서버에게 "www.naver.com"의 IP주소를 요청한다.

INFO)
ROOT DNS(루트 네임서버)란?

ROOT DNS는 인터넷의 도메인 네임 시스템의 루트 존이다.
ICANN이 직접 관리하는 절대 존엄 서버로, TLD DNS서버 IP들을 저장해두고 안내하는 역할을 한다.
전세계에 900개가 넘는 루트 DNS가 운영되고 있다.

만약 ROOT DNS에서 찾았으면 IP주소를 전달해주고 끝이지만 만약 없다면?
다른 DNS서버에게 물어봐 라고 응답을 하게 된다.

이제 LOCAL DNS서버는 com 도메인을 관리하는 TLD DNS서버(최상위 도메인 서버)에 다시 www.naver.com에 대한
IP주소를 요청한다.

INFO)
TLD(Top-Level Domain, 최상위 도메인) DNS SERVER란?

TLD는 도메인 등록 기관(Registry)이 관리하는 서버로, 도메인의 가장 마지막 부분을 말한다.
com이나 co.kr 과 같은 도메인들을 관리하고 부여하는 서버를 의미한다.
Authoritative DNS서버 주소를 저장해두고 안내하는 역할을 한다.

COM 도메인을 관리하는 DNS 서버에서도 만약 해당 정보가 없으면 또 다른 DNS서버에게 물어봐라고 응답한다.

이제 LOCAL DNS서버는 naver.com DNS서버 (Authoritative DNS서버)에게 다사 "www.naver.com"의 IP주소를 
요청한다.

INFO)
Authoritative DNS Server란?

실제 개인 도메인과 IP 주소의 관계가 기록/저장/변경되는 서버.
그래서 권한의 의미인 Authoritative가 붙는다.
일반적으로 도메인/호스팅 업체의 '네임서버'를 말하지만, 개인이나 회사 DNS서버 구축을 한경우에도
여기에 해당하게 된다.

NAVER.COM DNS서버에는 "www.naver.com의 IP주소"가 있다

그래서 LOCAL DNS서버에게 "www.naver.com"에 대한 IP주소는 222.1222.195.6 이다라는 응답을 해준다.

이를 수신한 LOCAL DNS는 www.naver.com의 IP주소를 캐싱하고 이후 다른 요청이 있을 시 응답할 수 있도록
IP주소 정보를 단말(PC)에 전달해준다.





















참조 : https://hanamon.kr/dns%EB%9E%80-%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%84%A4%EC%9E%84-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EA%B0%9C%EB%85%90%EB%B6%80%ED%84%B0-%EC%9E%91%EB%8F%99-%EB%B0%A9%EC%8B%9D%EA%B9%8C%EC%A7%80/
